(()=>{if("object"==typeof Breinify&&!Breinify.plugins._isAdded("recommendations")){let d=Breinify.UTL._jquery(),e=Breinify.plugins._overload(),i={notSet:!0},t={splitTests:{control:{itemSelector:i,containerSelector:i}},position:{before:i,after:i,prepend:i,append:i,replace:i},defaults:{},templates:{container:i,item:i},process:{error:function(e){},init:function(e){},pre:function(e){},attached:function(e,t){},post:function(e){}}},o={_process:function(e,...t){return!!d.isFunction(e)&&(e(t),!0)},_determineSelector:function(e){return"string"==typeof(e=d.isFunction(e)?e():e)?d(e):e instanceof d?e:null},_appendContainer:function(e){if(!d.isPlainObject(e)||!d.isPlainObject(e.position))return null;let t=null,n=null;return e.position.before!==i?(n=e.position.before,t="before"):e.position.after!==i?(n=e.position.after,t="after"):e.position.append!==i?(n=e.position.append,t="append"):e.position.prepend!==i?(n=e.position.prepend,t="prepend"):e.position.replace!==i&&(n=e.position.replace,t="replace"),null===(n=this._determineSelector(n))||null===(e=this._determineSelector(e.templates.container))?null:(t=n[t],d.isFunction(t)&&t(e),e)},_appendItems:function(e,t,n){if(null===this._determineSelector(n.templates.item))return null}};Breinify.plugins._add("recommendations",{render:function(){let i=this;e.overload({"Object,Object":function(e,n){n=this._preRenderRecommendations(n),this._retrieveRecommendations([e],function(e,t){i._renderRecommendations(n,e,t)})},"Array,Array":function(e,n){n=this._preRenderRecommendations(n),this._retrieveRecommendations(null,e,function(e,t){i._renderRecommendations(n,e,t)})},"String,Object":function(e,n){n=this._preRenderRecommendations(n),this._retrieveRecommendations([{namedRecommendations:[e]}],function(e,t){i._renderRecommendations(n,e,t)})},"String,Object,Object":function(e,t,n){n=this._preRenderRecommendations(n),this._retrieveRecommendations([d.extend({namedRecommendations:[e]},t)],function(e,t){i._renderRecommendations(n,e,t)})}},arguments,this)},get:function(){e.overload({"Object,Function":function(e,t){this._retrieveRecommendations([e],t)},"Array,Function":function(e,t){this._retrieveRecommendations(null,e,t)},"String,Function":function(e,t){this._retrieveRecommendations([{namedRecommendations:[e]}],t)},"String,Object,Function":function(e,t,n){this._retrieveRecommendations([d.extend({namedRecommendations:[e]},t)],n)}},arguments,this)},_preRenderRecommendations:function(e){e=d.extend({},t,e);return o._process(e.process.init),e},_renderRecommendations:function(e,t,n){if(null!==t)return o._process(e.process.error,t);o._process(e.process.pre,n);t=o._appendContainer(e);o._appendItems(t,n,e),o._process(e.process.attached,n),o._process(e.process.post,n)},_retrieveRecommendations:function(n,i){let o=this;Breinify.recommendation({},n,function(e,t){"string"==typeof t?i(new Error(t)):d.isArray(e.results)?(t=o._mapResults(n,e.results),i(null,t)):i(new Error("Invalid response received."))})},_mapResults:function(n,i){for(var o={},r=0;r<i.length;r++){var a=r<n.length&&d.isPlainObject(n[r])?n[r]:{},s=i[r],c={};this._determineErrorResponse(s,c)||this._determineSplitTestData(s,c)||this._determineRecommendationData(s,c),this._determineAdditionalData(s,c),this._determineMetaData(s,c);let e;e=d.isArray(a.namedRecommendations)&&1===a.namedRecommendations.length?a.namedRecommendations[0]:"response["+r+"]";let t;t="number"==typeof a.numRecommendations&&0<a.numRecommendations?a.numRecommendations:null,c.payload={name:e,expectedNumberOfRecommendations:t},o[e]=c}return o},_determineErrorResponse:function(e,t){return d.isPlainObject(e)?(200===e.statusCode||7120===e.statusCode?t.status={code:e.statusCode,message:e.message,error:!1}:t.status={error:!0,code:e.statusCode,message:e.message},t.status.error):(t.status={error:!0,code:500,message:"invalid result type received"},!0)},_determineRecommendationData:function(e,t){let n="com.brein.common.dto.CustomerProductDto";"com.brein.common.dto.CustomerProductDto"===(n=d.isPlainObject(e)&&d.isPlainObject(e._breinMetaData)&&"string"==typeof e._breinMetaData.dataType&&""!==e._breinMetaData.dataType.trim()?e._breinMetaData.dataType.trim():n)?t.recommendations=this._mapProducts(e):t.recommendations=this._mapAny(e)},_determineAdditionalData:function(e,t){},_determineMetaData:function(e,t){},_determineSplitTestData:function(e,t){return d.isPlainObject(e)&&d.isPlainObject(e.additionalData)&&d.isPlainObject(e.additionalData.splitTestData)?t.splitTestData=d.extend({active:!0,isTest:200===e.statusCode,isControl:7120===e.statusCode},e.additionalData.splitTestData):7120===t.statusCode?t.splitTestData={active:!0,isTest:!1,isControl:!1}:t.splitTestData={active:!1,isTest:!1,isControl:!1},t.active},_mapProducts:function(e){if(!d.isArray(e.result))return[];for(var t=[],n=0;n<e.result.length;n++){var i=e.result[n],i=this._mapProduct(i);t.push(i)}return t},_mapProduct:function(e){var t;return d.isPlainObject(e)&&"string"==typeof e.dataIdExternal&&d.isPlainObject(e.additionalData)?(t=null===(t=this._getValue(e,"inventory::productPrice"))?this._getValue(e,"product::productPrice"):t,{_recommenderWeight:e.weight,id:e.dataIdExternal,inventory:this._getValue(e,"inventory::inventoryQuantity"),name:this._getValue(e,"product::productName"),url:this._getValue(e,"product::productUrl"),image:this._getValue(e,"product::productImageUrl"),categories:this._getValue(e,"product::productCategories"),description:this._getValue(e,"product::productDescription"),price:t,additionalData:e.additionalData}):null},_mapAny:function(e){if(!d.isArray(e.result))return[];for(var t=[],n=0;n<e.result.length;n++){var i=e.result[n],i={_recommenderWeight:i.weight,id:i.dataIdExternal,additionalData:i.additionalData};t.push(i)}return t},_getValue:function(e,t){e=e.additionalData[t];return null==e?null:e}})}})();
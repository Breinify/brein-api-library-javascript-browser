"use strict";!function(){if("object"==typeof Breinify){var a=Breinify.UTL._jquery(),b=(Breinify.plugins._overload(),Breinify.UTL.constants.errors.prefix.validation,Breinify.UTL.constants.errors.prefix.api,"breinify-popup"),c='<div class="'+b+'"><div class="'+b+'-content"><div class="'+b+'-header"><div style="display:inline-block"></div><span class="'+b+'-close">&times;</span></div><div class="'+b+'-pages"></div><div class="'+b+'-footer"></div></div></div>',d='<style id="'+b+'-style">.'+b+"{display:none;position:fixed;z-index:1000;left:0;top:0;width:100%;height:100%;overflow:auto;background-color:#000;background-color:rgba(0,0,0,.4)}."+b+"-content>."+b+"-header{padding-bottom:0;min-height:16px}."+b+"-content{position:relative;background-color:#fefefe;margin:15% auto;padding:0px;border:1px solid #888;width:80%}."+b+"-close{position:absolute;right:10px;top:10px;line-height:12px;vertical-align:top;color:#aaa;float:right;font-size:28px;font-weight:700}."+b+"-close:focus,."+b+"-close:hover{color:#000;text-decoration:none;cursor:pointer}."+b+"-content>div{padding:10px}."+b+"-page{border:1px solid #e7e7e7;border-radius:4px;background:#f8f8f8 none repeat scroll 0 0;padding:10px 13px}</style>",e={loading:"",success:"",error:""},f=function(){};f.prototype.init=function(e,f){var g=this,h=a("body");this.currentPageNr=0,this.$pages=[],this.id=e,this.options=a.extend(!0,{showClose:!0,showFooter:!0,closeOnEscape:!0,header:null,maxWidth:null,bindings:null},f),0===a("#"+b+"-style").length&&h.append(d);var i=a("#"+e);if(0===i.length){var j=a(c);j.attr("id",e),h.append(j),this.$popup=j}else this.$popup=i;var k=this.$popup.find("."+b+"-close");this.getOption("showClose",!0)===!0?(k.show(),k.click(function(){g.hide()})):k.hide();var l=this.$popup.find("."+b+"-footer");this.getOption("showFooter",!0)===!0?l.show():l.hide();var m=this.getOption("maxWidth",null);if("number"==typeof m&&(m+="px"),"string"==typeof m){var n=this.$popup.find("."+b+"-content");n.css("maxWidth",m)}this.getOption("closeOnEscape",!0)===!0?(this.escHandler=function(a){27===a.keyCode&&g.hide()},a(document).bind("keyup",this.escHandler)):this.escHandler=null,this.setBindings(null),this.setHeader(null),this.id=e},f.prototype.css=function(b,c){var d=this.$popup.find(b);return d.css(a.isPlainObject(c)?c:{}),c},f.prototype.find=function(a){return this.$popup.find(a)},f.prototype.setBindings=function(b){this.bindings=a.isPlainObject(b)?b:this.getOption("bindings",{})},f.prototype.getBinding=function(a,b){var c=Breinify.UTL.getNestedByPath(this.bindings,a);return"undefined"==typeof c||null===c?b:c},f.prototype.extendBindings=function(b){this.bindings=a.extend(!0,{},this.bindings,b)},f.prototype.show=function(a){a=this.validatePage("number"==typeof a?a:1),this.showPage(a)},f.prototype.hide=function(b){a("html").css("marginRight","").css("overflow",""),this.$popup.hide()},f.prototype.destroy=function(){null!==this.escHandler&&(a(document).unbind("keyup",this.escHandler),this.escHandler=null)},f.prototype.addPage=function(c){var d,e;if("string"==typeof c)d=c,e=!1;else{if(!a.isPlainObject(c))return null;var f="string"==typeof c.style?c.style:"",g="string"==typeof c.html?c.html:"";d=f+g,e=a.isFunction(c.init)}var h=this.$popup.find("."+b+"-pages"),i=a('<div class="'+b+'-page">'+d+"</div>"),j=this.$pages.push(i);return i.attr("data-pageNr",j),i.hide(),h.append(i),e&&c.init(this,i,a.isPlainObject(settings)?settings:{}),i},f.prototype.addDefaultPage=function(a,b){var c=e[a];this.addPage(c)},f.prototype.showNextPage=function(){this.showPage(this.currentPageNr+1)},f.prototype.showPrevPage=function(){this.currentPageNr<=1||this.showPage(this.currentPageNr-1)},f.prototype.showPage=function(b){if(b=this.validatePage(b),0!==this.currentPageNr){var c=this.$pages[this.currentPageNr-1];this._resetBindings(c),c.hide()}if(this.currentPageNr=b,b>0){var d=this.$pages[b-1];this._applyBindings(d),d.show()}a("html").css("marginRight","15px").css("overflow","hidden"),this.$popup.show()},f.prototype._applyBindings=function(b){var c=this,d=b.find("[data-breinify-placeholder]"),e={popup:{currentPageNr:this.currentPageNr,totalPageNr:this.$pages.length}};d.each(function(){var b,d=a(this),f=d.attr("data-breinify-placeholder");b=0===f.indexOf("popup.")?Breinify.UTL.getNestedByPath(e,f):Breinify.UTL.getNestedByPath(c.bindings,f),d.text(b)})},f.prototype._resetBindings=function(a){a.find('[data-breinify-placeholder!=""]')},f.prototype.validatePage=function(a){return"number"==typeof a?Math.max(0,Math.min(this.$pages.length,a)):this.currentPageNr},f.prototype.setHeader=function(a){"string"!=typeof a&&(a=this.getOption("header",""));var c=this.$popup.find("."+b+"-header>div:first");c.html(a)},f.prototype.getOption=function(a,b){var c=this.options[a];return"undefined"==typeof c||null===c?b:c},Breinify.plugins._add("uiPopup",{create:function(a,b){var c=new f;return c.init(a,b),c}})}}();
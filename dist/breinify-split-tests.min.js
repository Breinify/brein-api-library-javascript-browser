(()=>{if("object"==typeof Breinify&&!Breinify.plugins._isAdded("splitTests")){let l=Breinify.UTL._jquery(),r={status:"setup",error:null,timing:{expirationAfterMs:36e5,intervalInMs:50,maxTimeInMs:15e3,durationInMs:0},storageKey:{live:null,test:null},tokens:{live:null,test:null},payload:null,cachedResult:null,init:function(t){let i=this,s=(t=l.isPlainObject(t)?t:{},this.tokens=l.extend(!0,{},this.tokens,l.isPlainObject(t.tokens)?t.tokens:{}),this.storageKey=l.extend(!0,{},this.storageKey,l.isPlainObject(t.storageKey)?t.storageKey:{}),this.timing=l.extend(!0,{},this.timing,l.isPlainObject(t.timing)?t.timing:{}),this.payload=l.isPlainObject(t.payload)||l.isFunction(t.payload)?t.payload:{},function(t,e){null!==t?(i.status="error",i.error=t):!0===e?(i.status="done",i.error=null):i.timing.durationInMs>=i.timing.maxTimeInMs?(i.status="timed-out",i.error=new Error("call timed out after "+i.timing.maxTimeInMs+"ms"),i.setSplitTestData({},null)):(i.status="loading",i.error=null,setTimeout(function(){i.timing.durationInMs+=i.timing.intervalInMs,i.resolveSplitTest(s)},i.timing.intervalInMs))});i.status="loading",this.resolveSplitTest(s)},resolveSplitTest:function(i){let s=this,n;var t;n=l.isFunction(this.payload)?this.payload(this.checkForUserInfo()):this.checkForUserInfo(),l.isPlainObject(n)?(t=this.getSplitTestData(),l.isPlainObject(t)&&"number"==typeof t.lastUpdated&&(new Date).getTime()-t.lastUpdated<=this.timing.expirationAfterMs?i(null,!0):(t=Breinify.UTL.internal.isDevMode()?this.tokens.test:this.tokens.live,Breinify.UTL.internal.token(t,n,function(t,e){null==t?(s.setSplitTestData(n,e),i(null,!0)):i(t,!1)},3e4))):i(null,!1)},determineSplitTestData:function(t){let e=this;var i;l.isFunction(t)&&("setup"===this.status||"loading"===this.status?setTimeout(function(){e.determineSplitTestData(t)},50):"error"===this.status||null!==this.error?(i=l.extend({status:this.status},this.getSplitTestData()),t(this.error,i)):(i=l.extend({status:this.status},this.getSplitTestData()),t(null,i)))},getSplitTestData:function(){if(null!==this.cachedResult)return this.cachedResult;var t=this.determineStorageKey();if(null===t)return null;try{var e=window.localStorage.getItem(t);return"string"==typeof e?JSON.parse(e):null}catch(t){return null}},setSplitTestData:function(t,e){var i=this.determineStorageKey(),s=(null===e&&(e={}),{lastUpdated:(new Date).getTime(),loggedInUser:"string"==typeof t.email});if(this.cachedResult=l.extend(!0,{},s,t,e),null!==i)try{window.localStorage.setItem(i,JSON.stringify(this.cachedResult))}catch(t){}try{var n=Breinify.UTL.user.getSplitTestData(),n=l.isPlainObject(n)?n:{};console.log(n),console.log(s),console.log(e)}catch(t){}},determineStorageKey:function(){return Breinify.UTL.internal.isDevMode()?this.storageKey.test:this.storageKey.live},checkForUserInfo:function(){var t=Breinify.UTL.user.create();return l.isPlainObject(t)?t:null}},o={initSplitTest:function(t,e,i,s){var n;return"string"==typeof t&&""!==t.trim()&&(t={live:t,test:t}),"string"==typeof i&&""!==i.trim()&&(i={live:i,test:i}),!l.isPlainObject(t)||("string"!=typeof t.test&&(t.test=t.live),l.isPlainObject(i)&&"string"!=typeof i.test&&(i.test=i.live),"string"!=typeof t.live)?null:((n=new Object.create(r)).init({payload:e,timing:s,storageKey:l.extend(!0,{live:null,test:null},l.isPlainObject(i)?i:{}),tokens:l.extend(!0,{live:null,test:null},l.isPlainObject(t)?t:{})}),n)}};Breinify.plugins._add("splitTests",{splitTests:{},retrieveSplitTest(t,e,i,s,n,l){let a=this.splitTests[t];return null==a&&(a=o.initSplitTest(e,i,s,l),this.splitTests[t]=a),console.log(a),console.log(a instanceof r),null===a?null:a.determineSplitTestData(n)}})}})();
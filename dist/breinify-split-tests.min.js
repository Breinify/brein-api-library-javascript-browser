(()=>{if("object"==typeof Breinify&&!Breinify.plugins._isAdded("splitTests")){let n=Breinify.UTL._jquery(),l={status:"setup",checker:{intervalInMs:50,maxTimeInMs:15e3,durationInMs:0},storageKey:{live:null,test:null},tokens:{live:null,test:null},cachedResult:null,init:function(t){let s=this,i=((t=n.isPlainObject(t)?t:{}).storageKey=n.extend(!0,{live:null,test:null},n.isPlainObject(t.storageKey)?t.storageKey:{}),t.tokens=n.extend(!0,{live:null,test:null},n.isPlainObject(t.tokens)?t.tokens:{}),this.storageKey.live=t.storageKey.live,this.storageKey.test=t.storageKey.test,this.tokens.live=t.tokens.live,this.tokens.test=t.tokens.test,function(t,e){null!==t?s.status="error":!0===e?s.status="done":s.checker.durationInMs>=s.checker.maxTimeInMs?(s.status="timed-out",s.setSplitTestData({},null)):(s.status="loading",setTimeout(function(){s.checker.durationInMs+=s.checker.intervalInMs,s.resolveSplitTest(i)},s.checker.intervalInMs))});s.status="loading",this.resolveSplitTest(i)},resolveSplitTest:function(s){let i=this,l=this.checkForUserInfo();if(n.isPlainObject(l)){var t=this.getSplitTestData();if(n.isPlainObject(t)&&!("number"==typeof t.lastUpdated&&36e5<(new Date).getTime()-t.lastUpdated)){if(l.email===t.email)return void s(null,!0);if(null===l.email)return i.setSplitTestData({},null),void s(null,!0)}t=Breinify.UTL.internal.isDevMode()?this.tokens.test:this.tokens.live;Breinify.UTL.internal.token(t,l,function(t,e){null==t?(i.setSplitTestData(l,e),s(null,!0)):s(t,!1)},3e4)}else s(null,!1)},determineSplitTestData:function(t){let e=this;var s;n.isFunction(t)&&("setup"!==this.status&&"loading"!==this.status?(s=n.extend({status:this.status},this.getSplitTestData()),t(s)):setTimeout(function(){e.determineSplitTestData(t)},50))},getSplitTestData:function(){if(null!==this.cachedResult)return this.cachedResult;var t=this.determineStorageKey();if(null===t)return null;try{var e=window.localStorage.getItem(t);return"string"==typeof e?JSON.parse(e):null}catch(t){return null}},setSplitTestData:function(t,e){var s=this.determineStorageKey(),i=(null===e&&(e={}),{lastUpdated:(new Date).getTime(),loggedInUser:"string"==typeof t.email});if(this.cachedResult=n.extend(!0,{},i,t,e),null!==s)try{window.localStorage.setItem(s,JSON.stringify(this.cachedResult))}catch(t){}try{var l=Breinify.UTL.user.getSplitTestData(),l=n.isPlainObject(l)?l:{};console.log(l),console.log(i),console.log(e)}catch(t){}},determineStorageKey:function(){return Breinify.UTL.internal.isDevMode()?this.storageKey.test:this.storageKey.live},checkForUserInfo:function(){var t=Breinify.UTL.user.create();return n.isPlainObject(t)?t:null}},a={initSplitTest:function(t,e){var s;return!n.isPlainObject(t)||("string"!=typeof t.test&&(t.test=t.live),n.isPlainObject(e)&&"string"!=typeof e.test&&(e.test=e.live),"string"!=typeof t.live)?null:((s=new Object.create(l)).init({storageKey:n.extend(!0,{live:null,test:null},n.isPlainObject(e)?e:{}),tokens:n.extend(!0,{live:null,test:null},n.isPlainObject(t)?t:{})}),s)}};Breinify.plugins._add("splitTests",{splitTests:{},retrieveSplitTest(t,e,s){let i=this.splitTests[t];return null==i&&(i=a.initSplitTest(e,s),this.splitTests[t]=i),console.log(i),console.log(i instanceof l),console.log(null===i?null:i.getSplitTestData()),null===i?null:i.getSplitTestData()}})}})();
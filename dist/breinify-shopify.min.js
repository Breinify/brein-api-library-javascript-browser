(()=>{if("object"==typeof Breinify&&!Breinify.plugins._isAdded("shopify")){let n={loadedToken:null,lookUpToken:null,currentCart:null,observers:[],init:function(t){let n=this;n._loadCart(),window.setInterval(function(){n._loadCart()},t.cartCheckInterval)},getToken:function(){let t=$.isFunction(this.lookUpToken)?this.lookUpToken():null;return t="string"==typeof t&&""!==t.trim()?t:this.lookUpToken},parseToken:function(t){return"string"==typeof t&&""!==t.trim()?"shopify::cart::"+t.replace(/\?key=[a-z\d]+$/,""):null},_loadCart:function(){let n=this;$.getJSON(window.Shopify.routes.root+"cart.js",function(t){"string"==typeof t.token&&""!==t.token.trim()&&(n.loadedToken=n.parseToken(t.token),n._checkCartChanges(t))})},_checkCartChanges:function(t){var n=this.currentCart,e=this._updateCart(t);if(null!==n&&!(null===e||n.isEmpty&&e.isEmpty)){var t=Object.keys(n.items),i=Object.keys(e.items),r=[...new Set([...t,...i])],s=[],o=[];for(let t=0;t<r.length;t++){var a=r[t],u=n.items[a],a=e.items[a];$.isPlainObject(u)&&$.isPlainObject(a)?u.quantity>a.quantity?s.push($.extend(!0,{},u,{quantity:u.quantity-a.quantity})):u.quantity<a.quantity&&o.push($.extend(!0,{},a,{quantity:a.quantity-u.quantity})):$.isPlainObject(u)?s.push(u):o.push(a)}if(0<s.length||0<o.length)for(let t=0;t<this.observers.length;t++)(0,this.observers[t])(o,s)}},_updateCart:function(n){if($.isPlainObject(n)){var t=n.item_count;if("number"==typeof t)if(0===t)this.currentCart={isEmpty:!0,size:0,quantity:0,items:{}};else if($.isArray(n.items)){this.currentCart={isEmpty:!0,size:0,quantity:0,items:{}};for(let t=0;t<n.items.length;t++){var e=n.items[t],i=null===(i=Breinify.UTL.toInteger(e.id))?null:""+i;if(null!==i&&"40255563595860"!==i){var r=Breinify.UTL.toInteger(e.quantity);this.currentCart.isEmpty=!1,this.currentCart.size++,this.currentCart.quantity+=null===r?0:r;let t=this.currentCart.items[i];$.isPlainObject(t)||(t={quantity:0},this.currentCart.items[i]=t),t.id=i,t.name=Breinify.UTL.isNonEmptyString(e.product_title),t.quantity+=r}}}}return this.currentCart}};Breinify.plugins._add("shopify",{init:function(){var t=this.getConfig("cart::refreshRateInMs",250);n.init({cartCheckInterval:t})},cart:{onCartChange:function(t){$.isFunction(t)&&n.observers.push(t)},bindLookUpToken:function(t){n.lookUpToken=$.isFunction(t)?function(){return n.parseToken(t())}:null},getToken:function(){return n.getToken()}}})}})();
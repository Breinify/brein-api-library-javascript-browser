"use strict";!function(){var o,r;"object"!=typeof Breinify||Breinify.plugins._isAdded("unsubscribe")||(o=Breinify.UTL._jquery(),Breinify.plugins._overload(),r={tokenCodeValidation:null,tokenCodeUnsubscribe:null,getValidationToken:function(){return null===this.tokenCodeValidation&&(this.tokenCodeValidation=this._determineValidationToken()),this.tokenCodeValidation},getUnsubscribeToken:function(){return null===this.tokenCodeUnsubscribe&&(this.tokenCodeUnsubscribe=this._determineUnsubscribeToken()),this.tokenCodeUnsubscribe},getCode:function(e){return null===(e=null!==e&&"string"==typeof e?e:Breinify.UTL.loc.param("c"))||"string"!=typeof e?null:e},_determineValidationToken:function(){return this._determineToken("tokenCodeValidation","testTokenCodeValidation")},_determineUnsubscribeToken:function(){return this._determineToken("tokenCodeUnsubscribe","testTokenCodeUnsubscribe")},_determineToken:function(e,n){var i=null;return i=null===(i=Breinify.plugins._isAdded("api")&&"prod"!==Breinify.plugins.api.determineMode()?this.getConfig(n,null):i)?this.getConfig(e,null):i}},Breinify.plugins._add("unsubscribe",{code:function(){return r.getCode()},validate:function(t,e){var n=r.getValidationToken();e=r.getCode(e),o.ajax({url:"https://api.breinify.com/res/"+n,type:"GET",crossDomain:!0,data:{code:e},success:function(e){o.isPlainObject(e)&&o.isPlainObject(e.payload)&&"string"==typeof e.payload.email&&""!==e.payload.email.trim()?t(null,e.payload):t(new Error("failed to validate the specified code"))},error:function(e,n,i){t(new Error("failed to validate the specified code: "+n))},timeout:6e4})},unsubscribe:function(e,t,n){var i=r.getUnsubscribeToken();n=r.getCode(n),"string"!=typeof i?t(new Error("unsubscribe token not configured")):"string"!=typeof n?t(new Error("unsubscribe code not specified or found")):o.ajax({url:"https://api.breinify.com/res/"+i,type:"GET",crossDomain:!0,data:{code:n,status:e},success:function(e){o.isPlainObject(e)&&o.isPlainObject(e.payload)&&"string"==typeof e.payload.email&&""!==e.payload.email.trim()?t(null,e.payload):t(new Error("failed to unsubscribe"))},error:function(e,n,i){t(new Error("failed to unsubscribe: "+n))},timeout:6e4})}}))}();
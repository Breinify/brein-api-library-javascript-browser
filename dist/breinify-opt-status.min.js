(()=>{if("object"==typeof Breinify&&!Breinify.plugins._isAdded("optStatus")){let c=Breinify.UTL._jquery(),o={handleError:function(e,t){c.isFunction(t)&&t(e)},validateToken:function(e,t){return"string"==typeof e&&e.trim()===e&&""!==e||(c.isFunction(t)&&t(new Error("Invalid token specified: "+e)),!1)},handleOptCodeValidation:function(e,t){c.isFunction(t)&&t(null,e)},handleOptStatusChange:function(e,t){c.isFunction(t)&&t(null,e)}};Breinify.plugins._add("optStatus",{tokens:function(){return{validateOptCode:this.getConfig("tokenValidateOptCode",null),optViaCode:this.getConfig("tokenOptViaCode",null)}},hasValidTokens:function(){var e=this.tokens().validateOptCode,t=this.tokens().optViaCode;return o.validateToken(e)&&o.validateToken(t)},isValidCode:function(e){return"string"==typeof e&&e===e.trim()&&""!==e},validateOptCode:function(e,n){var t=this.tokens().validateOptCode;o.validateToken(t,n)&&Breinify.UTL.internal.token(t,{code:e},function(e,t){null==e?o.handleOptCodeValidation(t,n):o.handleError(e,n)},3e4)},optViaCode:function(e,n,t){var i=this.tokens().optViaCode;o.validateToken(i,n)&&Breinify.UTL.internal.token(i,c.extend({code:e},t),function(e,t){null==e?o.handleOptStatusChange(t,n):o.handleError(e,n)},3e4)},opt:function(t,l,e,s,r){var d=this.getConfig("tokenOpt",null);if(!1===o.validateToken(d))r({success:!1,failed:[],results:{}});else if(c.isPlainObject(t)){t=Object.entries(t);if(0===t.length)r({success:!0,failed:[],results:{}});else{e=c.isArray(e)?e:[];var u=!0===l?e:[],f=!1===l?e:[];s=c.isPlainObject(e)?s:{};let i={},o=[],a=t.length;for(let[n,e]of t)Breinify.UTL.internal.token(d,{optInGeneral:!0===l,optInCampaigns:u,optOutGeneral:!1===l,optOutCampaigns:f,deliveryChannel:n,user:e,additionalData:s},function(e,t){null!==e?(i[n]={error:e},o.push(n)):i[n]={response:t},0===--a&&r({success:0===o.length,failed:o,results:i})},3e4)}}else r({success:!1,failed:[],results:{}})}})}})();
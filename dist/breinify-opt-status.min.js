(()=>{if("object"==typeof Breinify&&!Breinify.plugins._isAdded("optStatus")){let c=Breinify.UTL._jquery(),o={handleError:function(e,n){c.isFunction(n)&&n(e)},validateToken:function(e,n){return"string"==typeof e&&e.trim()===e&&""!==e||(c.isFunction(n)&&n(new Error("Invalid token specified: "+e)),!1)},handleOptCodeValidation:function(e,n){c.isFunction(n)&&n(null,e)},handleOptStatusChange:function(e,n){c.isFunction(n)&&n(null,e)}};Breinify.plugins._add("optStatus",{_tokens:function(){return{validateOptCode:this.getConfig("tokenValidateOptCode",null),optViaCode:this.getConfig("tokenOptViaCode",null)}},hasValidTokens:function(){var e=this._tokens().validateOptCode,n=this._tokens().optViaCode;return o.validateToken(e)&&o.validateToken(n)},isValidCode:function(e){return"string"==typeof e&&e===e.trim()&&""!==e},validateOptCode:function(e,t){var n=this._tokens().validateOptCode;o.validateToken(n,t)&&Breinify.UTL.internal.token(n,{code:e},function(e,n){null==e?o.handleOptCodeValidation(n,t):o.handleError(e,t)},3e4)},optViaCode:function(e,t,n){var i=this._tokens().optViaCode;o.validateToken(i,t)&&Breinify.UTL.internal.token(i,c.extend({code:e},n),function(e,n){null==e?o.handleOptStatusChange(n,t):o.handleError(e,t)},3e4)},opt:function(n,s,e,l,r){var d=this.getConfig("tokenOpt",null);if(!1===o.validateToken(d))r({success:!1,failed:[],results:{}});else if(c.isPlainObject(n)){n=Object.entries(n);if(0===n.length)r({success:!0,failed:[],results:{}});else{e=c.isArray(e)?e:[];var u=!0===s?e:[],f=!1===s?e:[];l=c.isPlainObject(l)?l:{};let i={},o=[],a=n.length;for(let[t,e]of n)Breinify.UTL.internal.token(d,{optInGeneral:!0===s,optInCampaigns:u,optOutGeneral:!1===s,optOutCampaigns:f,deliveryChannel:t,user:e,additionalData:l},function(e,n){null===e&&c.isPlainObject(n)?!0===n.success?i[t]={response:n}:i[t]={error:"unsuccessful response: "+JSON.stringify(n)}:(i[t]={error:e},o.push(t)),0===--a&&r({success:0===o.length,failed:o,results:i})},3e4)}}else r({success:!1,failed:[],results:{}})}})}})();
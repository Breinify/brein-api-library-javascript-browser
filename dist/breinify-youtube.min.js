(()=>{if("object"==typeof Breinify&&!Breinify.plugins._isAdded("youtube")){let l=Breinify.UTL._jquery(),r={frequencyInMs:1e3,initialized:!1,type:null,listenerName:"YT_VIDEO_STARTED_BRE_LISTENER",videoIdToElementIdMapper:{},videoIdHandler:{},startedVideoIds:{},playTimelines:{},playObserver:{},init:function(){if(!0!==this.initialized){if("object"!=typeof YT||"function"!=typeof YT.Player)return!1;let t=this;window[this.listenerName]=function(e){t.youTubeEventHandler(e)},this.initialized=!0}return!0},stopTimelineRecording:function(e,t){var i=l.isArray(e)?e:[e],n={};for(let e=0;e<i.length;e++){var r=i[e],a=this.playObserver[r],a=(window.clearInterval(a),!0===t&&this.checkVideoStatus(r),this.getTimelineRecording(r));delete this.playTimelines[r],delete this.playObserver[r],l.isPlainObject(a)&&(n[r]=a)}return n},isTimelineRecorded:function(e){return l.isPlainObject(this.playTimelines[e])},startTimelineRecording:function(e){let i=this;var n=l.isArray(e)?e:[e],r=[];for(let t=0;t<n.length;t++){let e=n[t];l.isPlainObject(this.playTimelines[e])||(this.playTimelines[e]={timeline:[]},this.checkVideoStatus(e),this.playObserver[e]=setInterval(function(){i.checkVideoStatus(e)},this.frequencyInMs),r.push(e))}return r},getTimelineRecording:function(e){e=this.playTimelines[e];return l.isPlainObject(e)?e:null},checkVideoStatus:function(e){var t,i,n,r=this.getPlayerByVideoId(e);l.isFunction(r.getPlayerState)&&(i=r.getPlayerState())!==YT.PlayerState.UNSTARTED&&(t=(new Date).getTime(),n=this.playTimelines[e].video,n=l.isPlainObject(n)?n:{start:t,currentState:YT.PlayerState.UNSTARTED},i!==YT.PlayerState.ENDED||n.currentState!==YT.PlayerState.ENDED)&&(i=this.getVideoStats(r),this.playTimelines[e].timeline.push(i.percentage),this.playTimelines[e].video=l.extend(i,{start:n.start,lastUpdate:t}))},getVideoStats:function(e){var t=e.getPlayerState();let i=e.getCurrentTime(),n=e.getDuration();n="number"==typeof n?n.toFixed(2):0,i="number"==typeof i?i.toFixed(2):0;var r=0===n?0:Math.min(1,(i/n).toFixed(4));return{videoId:this.getVideoIdByPlayer(e),currentState:t,currentDuration:i,totalDuration:n,frequencyInMs:this.frequencyInMs,percentage:r,finished:1===r}},youTubeEventHandler:function(t){var i=this.getVideoIdByPlayer(t.target);if(null!==i){var n=this.getElementByVideoId(i);if(null!==n){var r=this.videoIdHandler[i];if(l.isArray(r)){let e=this.startedVideoIds[i];"boolean"!=typeof e&&(e=t.data===YT.PlayerState.PLAYING&&!(this.startedVideoIds[i]=!1));var a=l.extend(this.getVideoStats(t.target),{firstStart:e});for(let e=0;e<r.length;e++)r[e](i,n,t,a)}}}},bindYouTubeObserver:function(e,t){var i,n;return!l.isFunction(t)||"string"!=typeof(e=e.attr("id"))||""===e.trim()||(i=YT.get(e),null===(n=this.getVideoIdByPlayer(i)))?null:("string"==typeof this.videoIdToElementIdMapper[n]?this.videoIdHandler[n].push(t):(this.videoIdHandler[n]=[t],this.videoIdToElementIdMapper[n]=e,i.addEventListener("onStateChange",this.listenerName)),n)},getElementByVideoId:function(e){return"string"==typeof e&&(e=this.videoIdToElementIdMapper[e],1===(e=l("#"+e)).length)?e:null},getPlayerByVideoId:function(e){var e=this.getElementByVideoId(e).attr("id");return"string"==typeof e&&""!==e.trim()&&"object"==typeof(e=YT.get(e))?e:null},getVideoIdByElement:function(e){var e=e.attr("id");return"string"==typeof e&&""!==e.trim()&&"object"==typeof(e=YT.get(e))?this.getVideoIdByPlayer(e):null},getVideoIdByPlayer:function(e){return"object"==typeof e&&l.isFunction(e.getVideoData)&&(e=e.getVideoData(),"string"==typeof(e=l.isPlainObject(e)?e.video_id:null))?e:null}};Breinify.plugins._add("youtube",{init:function(){return r.init()},isTimelineRecorded:function(e){return r.isTimelineRecorded(e)},isPlaying:function(e){return e.data===YT.PlayerState.PLAYING},isHalted:function(e){return e.data===YT.PlayerState.BUFFERING||e.data===YT.PlayerState.CUED||e.data===YT.PlayerState.PAUSED||e.data===YT.PlayerState.UNSTARTED},isEnded:function(e){return e.data===YT.PlayerState.ENDED},isInitialized:function(){return r.initialized},startTimelineRecording:function(e){return r.startTimelineRecording(e)},stopTimelineRecording:function(e,t){return r.stopTimelineRecording(e,t)},getTimelineRecording:function(e){return r.getTimelineRecording(e)},getVideoIdByElement:function(e){return r.getVideoIdByElement(e)},isObservable:function(e,i){let n=this;e.each(function(e){let t=l(this);null===n.getVideoIdByElement(t)?setTimeout(function(){n.isObservable(t,i)},50):i(t)})},observeElements:function(e,i){let n=[];return this.init()&&e.each(function(e){var t=r.bindYouTubeObserver(l(this),i);null!==t&&n.push(t)}),n}})}})();
"use strict";!function(){if("object"==typeof Breinify&&!Breinify.plugins._isAdded("youtube")){var a=Breinify.UTL._jquery(),b=(Breinify.plugins._overload(),{frequencyInMs:1e3,initialized:!1,type:null,listenerName:"YT_VIDEO_STARTED_BRE_LISTENER",videoIdToElementIdMapper:{},videoIdHandler:{},startedVideoIds:{},playTimelines:{},playObserver:{},init:function(){if(this.initialized===!0)return!0;if("object"!=typeof YT||"function"!=typeof YT.Player)return!1;var a=this;return window[this.listenerName]=function(b){a.youTubeEventHandler(b)},this.initialized=!0,!0},stopTimelineRecording:function(b,c){for(var d=a.isArray(b)?b:[b],e={},f=0;f<d.length;f++){var g=d[f],h=this.playObserver[g];window.clearInterval(h),c===!0&&this.checkVideoStatus(g);var i=this.getTimelineRecording(g);delete this.playTimelines[g],delete this.playObserver[g],a.isPlainObject(i)&&(e[g]=i)}return e},startTimelineRecording:function(b){for(var c=this,d=a.isArray(b)?b:[b],e=[],f=0;f<d.length;f++){var g=d[f];a.isPlainObject(this.playTimelines[g])||(this.playTimelines[g]={timeline:[]},this.checkVideoStatus(g),this.playObserver[g]=setInterval(function(){c.checkVideoStatus(g)},this.frequencyInMs),e.push(g))}return e},getTimelineRecording:function(b){var c=this.playTimelines[b];return a.isPlainObject(c)?c:null},checkVideoStatus:function(b){var c=this.getPlayerByVideoId(b);if(a.isFunction(c.getPlayerState)){var d=c.getPlayerState();if(d!==YT.PlayerState.UNSTARTED){var e=(new Date).getTime(),f=this.playTimelines[b].video;if(f=a.isPlainObject(f)?f:{start:e,currentState:YT.PlayerState.UNSTARTED},d!==YT.PlayerState.ENDED||f.currentState!==YT.PlayerState.ENDED){var g=c.getCurrentTime(),h=c.getDuration();h="number"==typeof h?h.toFixed(2):0,g="number"==typeof g?g.toFixed(2):0,this.playTimelines[b].timeline.push(0===h?0:Math.min(1,(g/h).toFixed(4))),this.playTimelines[b].video={start:f.start,currentState:d,videoId:b,lastUpdate:e,totalDuration:h,frequencyInMs:this.frequencyInMs}}}}},youTubeEventHandler:function(b){var c=this.getVideoIdByPlayer(b.target);if(null!==c){var d=this.getElementByVideoId(c);if(null!==d){var e=this.videoIdHandler[c];if(a.isArray(e)){var f=this.startedVideoIds[c];"boolean"==typeof f||(b.data===YT.PlayerState.PLAYING?(this.startedVideoIds[c]=!0,f=!0):f=!1);for(var g=0;g<e.length;g++)e[g](c,d,b,{firstStart:f})}}}},bindYouTubeObserver:function(b,c){if(!a.isFunction(c))return null;var d=b.attr("id");if("string"!=typeof d&&""===d)return null;var e=YT.get(d),f=this.getVideoIdByPlayer(e);return null===f?null:"string"==typeof this.videoIdToElementIdMapper[f]?(this.videoIdHandler[f].push(c),f):(this.videoIdHandler[f]=[c],this.videoIdToElementIdMapper[f]=d,e.addEventListener("onStateChange",this.listenerName),f)},getElementByVideoId:function(b){if("string"!=typeof b)return null;var c=this.videoIdToElementIdMapper[b],d=a("#"+c);return 1===d.length?d:null},getPlayerByVideoId:function(a){var b=this.getElementByVideoId(a),c=b.attr("id");if("string"!=typeof c&&""===c)return null;var d=YT.get(c);return"object"==typeof d?d:null},getVideoIdByElement:function(a){var b=a.attr("id");if("string"!=typeof b&&""===b)return null;var c=YT.get(b);return"object"==typeof c?this.getVideoIdByPlayer(c):null},getVideoIdByPlayer:function(b){if("object"!=typeof b||!a.isFunction(b.getVideoData))return null;var c=b.getVideoData(),d=a.isPlainObject(c)?c.video_id:null;return"string"==typeof d?d:null}}),c={init:function(){return b.init()},isPlaying:function(a){return a.data===YT.PlayerState.PLAYING},isHalted:function(a){return a.data===YT.PlayerState.BUFFERING||a.data===YT.PlayerState.CUED||a.data===YT.PlayerState.PAUSED||a.data===YT.PlayerState.UNSTARTED},isEnded:function(a){return a.data===YT.PlayerState.ENDED},isInitialized:function(){return b.initialized},startTimelineRecording:function(a){return b.startTimelineRecording(a)},stopTimelineRecording:function(a,c){return b.stopTimelineRecording(a,c)},getTimelineRecording:function(a){return b.getTimelineRecording(a)},getVideoIdByElement:function(a){return b.getVideoIdByElement(a)},observeElements:function(c,d){var e=[];return this.init()&&c.each(function(c){var f=b.bindYouTubeObserver(a(this),d);null!==f&&e.push(f)}),e}};Breinify.plugins._add("youtube",c)}}();
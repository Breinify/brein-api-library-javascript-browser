"use strict";!function(){var l,r;"object"!=typeof Breinify||Breinify.plugins._isAdded("youtube")||(l=Breinify.UTL._jquery(),r={frequencyInMs:1e3,initialized:!1,type:null,listenerName:"YT_VIDEO_STARTED_BRE_LISTENER",videoIdToElementIdMapper:{},videoIdHandler:{},startedVideoIds:{},playTimelines:{},playObserver:{},init:function(){if(!0!==this.initialized){if("object"!=typeof YT||"function"!=typeof YT.Player)return!1;var t=this;window[this.listenerName]=function(e){t.youTubeEventHandler(e)},this.initialized=!0}return!0},stopTimelineRecording:function(e,t){for(var i=l.isArray(e)?e:[e],n={},r=0;r<i.length;r++){var a=i[r],o=this.playObserver[a],o=(window.clearInterval(o),!0===t&&this.checkVideoStatus(a),this.getTimelineRecording(a));delete this.playTimelines[a],delete this.playObserver[a],l.isPlainObject(o)&&(n[a]=o)}return n},isTimelineRecorded:function(e){return l.isPlainObject(this.playTimelines[e])},startTimelineRecording:function(e){for(var t=this,i=l.isArray(e)?e:[e],n=[],r=0;r<i.length;r++){var a=i[r];l.isPlainObject(this.playTimelines[a])||(this.playTimelines[a]={timeline:[]},this.checkVideoStatus(a),this.playObserver[a]=setInterval(function(){t.checkVideoStatus(a)},this.frequencyInMs),n.push(a))}return n},getTimelineRecording:function(e){e=this.playTimelines[e];return l.isPlainObject(e)?e:null},checkVideoStatus:function(e){var t,i,n,r=this.getPlayerByVideoId(e);l.isFunction(r.getPlayerState)&&(i=r.getPlayerState())!==YT.PlayerState.UNSTARTED&&(t=(new Date).getTime(),n=this.playTimelines[e].video,n=l.isPlainObject(n)?n:{start:t,currentState:YT.PlayerState.UNSTARTED},i!==YT.PlayerState.ENDED||n.currentState!==YT.PlayerState.ENDED)&&(i=this.getVideoStats(r),this.playTimelines[e].timeline.push(i.percentage),this.playTimelines[e].video=l.extend(i,{start:n.start,lastUpdate:t}))},getVideoStats:function(e){var t=e.getPlayerState(),i=e.getCurrentTime(),n="number"==typeof(n=e.getDuration())?n.toFixed(2):0,i="number"==typeof i?i.toFixed(2):0,r=0===n?0:Math.min(1,(i/n).toFixed(4));return{videoId:this.getVideoIdByPlayer(e),currentState:t,currentDuration:i,totalDuration:n,frequencyInMs:this.frequencyInMs,percentage:r,finished:1===r}},youTubeEventHandler:function(e){var t=this.getVideoIdByPlayer(e.target);if(null!==t){var i=this.getElementByVideoId(t);if(null!==i){var n=this.videoIdHandler[t];if(l.isArray(n))for(var r=this.startedVideoIds[t],a=("boolean"!=typeof r&&(r=e.data===YT.PlayerState.PLAYING&&!(this.startedVideoIds[t]=!1)),l.extend(this.getVideoStats(e.target),{firstStart:r})),o=0;o<n.length;o++)n[o](t,i,e,a)}}},bindYouTubeObserver:function(e,t){var i,n;return!l.isFunction(t)||"string"!=typeof(e=e.attr("id"))||""===e.trim()||(i=YT.get(e),null===(n=this.getVideoIdByPlayer(i)))?null:("string"==typeof this.videoIdToElementIdMapper[n]?this.videoIdHandler[n].push(t):(this.videoIdHandler[n]=[t],this.videoIdToElementIdMapper[n]=e,i.addEventListener("onStateChange",this.listenerName)),n)},getElementByVideoId:function(e){return"string"==typeof e&&(e=this.videoIdToElementIdMapper[e],1===(e=l("#"+e)).length)?e:null},getPlayerByVideoId:function(e){var e=this.getElementByVideoId(e).attr("id");return"string"==typeof e&&""!==e.trim()&&"object"==typeof(e=YT.get(e))?e:null},getVideoIdByElement:function(e){var e=e.attr("id");return"string"==typeof e&&""!==e.trim()&&"object"==typeof(e=YT.get(e))?this.getVideoIdByPlayer(e):null},getVideoIdByPlayer:function(e){return"object"==typeof e&&l.isFunction(e.getVideoData)&&(e=e.getVideoData(),"string"==typeof(e=l.isPlainObject(e)?e.video_id:null))?e:null}},Breinify.plugins._add("youtube",{init:function(){return r.init()},isTimelineRecorded:function(e){return r.isTimelineRecorded(e)},isPlaying:function(e){return e.data===YT.PlayerState.PLAYING},isHalted:function(e){return e.data===YT.PlayerState.BUFFERING||e.data===YT.PlayerState.CUED||e.data===YT.PlayerState.PAUSED||e.data===YT.PlayerState.UNSTARTED},isEnded:function(e){return e.data===YT.PlayerState.ENDED},isInitialized:function(){return r.initialized},startTimelineRecording:function(e){return r.startTimelineRecording(e)},stopTimelineRecording:function(e,t){return r.stopTimelineRecording(e,t)},getTimelineRecording:function(e){return r.getTimelineRecording(e)},getVideoIdByElement:function(e){return r.getVideoIdByElement(e)},isObservable:function(e,i){var n=this;e.each(function(e){var t=l(this);null===n.getVideoIdByElement(t)?setTimeout(function(){n.isObservable(t,i)},50):i(t)})},observeElements:function(e,i){var n=[];return this.init()&&e.each(function(e){var t=r.bindYouTubeObserver(l(this),i);null!==t&&n.push(t)}),n}}))}();
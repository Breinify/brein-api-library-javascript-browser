"use strict";!function(){if("object"==typeof Breinify&&!Breinify.plugins._isAdded("youtube")){var a=Breinify.UTL._jquery(),b=(Breinify.plugins._overload(),{frequencyInMs:1e3,initialized:!1,type:null,listenerName:"YT_VIDEO_STARTED_BRE_LISTENER",videoIdToElementIdMapper:{},videoIdHandler:{},startedVideoIds:{},playTimelines:{},playObserver:{},init:function(){if(this.initialized===!0)return!1;var a=this;return window[this.listenerName]=function(b){a.youTubeEventHandler(b)},this.initialized=!0,!0},activateTimelineRecording:function(b){var c=this;return!a.isPlainObject(this.playTimelines[b])&&(this.playTimelines[b]={timeline:[]},this.checkVideoStatus(b),this.playObserver[b]=setInterval(function(){c.checkVideoStatus(b)},this.frequencyInMs),!0)},getTimelineRecording:function(b){var c=this.playTimelines[b];return a.isPlainObject(c)?c:null},checkVideoStatus:function(b){var c=this.getPlayerByVideoId(b);if(a.isFunction(c.getPlayerState)){var d=(new Date).getTime(),e=this.playTimelines[b].video;e=a.isPlainObject(e)?e:{start:d,currentState:YT.PlayerState.UNSTARTED};var f=c.getPlayerState();if(f!==YT.PlayerState.ENDED||e.currentState!==YT.PlayerState.ENDED){var g=c.getCurrentTime(),h=c.getDuration();h="number"==typeof h?h.toFixed(2):0,g="number"==typeof g?g.toFixed(2):0,this.playTimelines[b].timeline.push(0===h?0:Math.min(1,(g/h).toFixed(4))),this.playTimelines[b].video={start:e.start,currentState:f,videoId:b,lastUpdate:d,totalDuration:h,frequencyInMs:this.frequencyInMs}}}},youTubeEventHandler:function(b){var c=this.getVideoId(b.target);if(null!==c){var d=this.getElementByVideoId(c);if(null!==d){var e=this.videoIdHandler[c];if(a.isArray(e)){var f=this.startedVideoIds[c];typeof f===boolean||(b.data===YT.PlayerState.PLAYING?(this.startedVideoIds[c]=!0,f=!0):f=!1);for(var g=0;g<e.length;g++)e[g](c,d,b,{firstStart:f})}}}},bindYouTubeObserver:function(b,c){if(!a.isFunction(c))return null;var d=b.attr("id");if("string"!=typeof d&&""===d)return null;var e=YT.get(d),f=this.getVideoId(e);return null===f?null:"string"==typeof this.videoIdToElementIdMapper[f]?(this.videoIdHandler[f].push(c),f):(this.videoIdHandler[f]=[c],this.videoIdToElementIdMapper[f]=d,e.addEventListener("onStateChange",this.listenerName),f)},getElementByVideoId:function(b){if("string"!=typeof b)return null;var c=this.videoIdToElementIdMapper[b],d=a("#"+c);return 1===d.length?d:null},getPlayerByVideoId:function(a){var b=this.getElementByVideoId(a),c=b.attr("id");if("string"!=typeof c&&""===c)return null;var d=YT.get(c);return"object"==typeof d?d:null},getVideoId:function(b){if("object"!=typeof b||!a.isFunction(b.getVideoData))return null;var c=b.getVideoData(),d=a.isPlainObject(c)?c.video_id:null;return"string"==typeof d?d:null}}),c={init:function(){b.init()},isInitialized:function(){return b.initialized},activateTimelineRecording:function(a){return b.activateTimelineRecording(a)},observeElements:function(c,d){this.init();var e=[];return c.each(function(c){var f=b.bindYouTubeObserver(a(this),d);null!==f&&e.push(f)}),e}};Breinify.plugins._add("youtube",c)}}();
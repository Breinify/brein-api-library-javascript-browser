(()=>{if("object"==typeof Breinify&&!Breinify.plugins._isAdded("uiRecommendations")){let r=Breinify.UTL._jquery(),a=["before","after","prepend","append","replace","externalRender"],i={handle:async function(n,e){e=await Promise.all(e.map(e=>Promise.resolve().then(()=>i._handle(n,e)).catch(e=>(console.error(e),null))));Breinify.plugins.recommendations.render(e)},_handle:async function(e,n){var t={};if(r.isPlainObject(n))return t.recommender=await this._createPayload(n.recommender),t.activity=this._createActivitySettings(n),t.splitTests=this._createSplitTestsSettings(n.splitTestControl),t.position=this._createPosition(n.position),t.placeholders=this._createPlaceholders(n.placeholders),t.templates=this._createTemplates(n.templates),t.process=this._createProcess(e,n.process),t},_createProcess:function(t,e){let n,i=(n=r.isPlainObject(e)?Object.fromEntries(Object.entries(e).flatMap(([e,n])=>{n=Breinify.plugins.snippetManager.getSnippet(n);return null==n?[]:[[e,n]]})):{},null);return r.isFunction(n.createActivity)&&(i=n.createActivity),n.createActivity=function(e,n){r.isFunction(i)&&i.call(this,e,n),n.activityTags.campaignWebExId=t},n},_createPosition:function(e){if(!r.isPlainObject(e))return{};let n=Breinify.UTL.isNonEmptyString(e.operation);if(null===n)return{};if(n=n.toLowerCase(),-1===a.indexOf(n))return{};let t=Breinify.UTL.isNonEmptyString(e.selector);e=Breinify.UTL.isNonEmptyString(e.snippet);let i=null;return(null!==t||null!==e)&&(i=null!==t?function(){return r(t)}:Breinify.plugins.snippetManager.getSnippet(containerSnippetId),r.isFunction(i))?{[n]:i}:{}},_createTemplates:function(e){var n;return r.isPlainObject(e)?(n=Breinify.UTL.isNonEmptyString(e.container),e=Breinify.UTL.isNonEmptyString(e.item),{container:Breinify.plugins.snippetManager.getSnippet(n),item:Breinify.plugins.snippetManager.getSnippet(e)}):{}},_createSplitTestsSettings:function(e){return!r.isPlainObject(e)||null===(e=Breinify.UTL.isNonEmptyString(e.selector))?{}:{control:{containerSelector:e}}},_createPlaceholders:function(e){return r.isPlainObject(e)?Object.fromEntries(Object.entries(e).flatMap(([e,n])=>{n=Breinify.plugins.snippetManager.getSnippet(n);return null==n?[]:[[e,n]]})):{}},_createActivitySettings:function(e){e=r.isPlainObject(e)?Breinify.UTL.isNonEmptyString(e.activityType):null;return{type:null===e?"clickedRecommendation":e}},_createPayload:async function(e){var n;return r.isPlainObject(e)?(n=Breinify.UTL.isNonEmptyString(e.preconfiguredRecommendation),{payload:{recommendationQueryName:e=null===(e=Breinify.UTL.isNonEmptyString(e.queryLabel))?n:e,namedRecommendations:[n]}}):{}}};Breinify.plugins._add("uiRecommendations",{register:function(){},handle:function(e,n){let t=r.isArray(n.recommendations)?n.recommendations:[];0!==t.length&&Promise.resolve().then(()=>i.handle(e,t)).catch(e=>{})}})}})();
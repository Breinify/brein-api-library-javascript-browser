"use strict";!function(){if("object"==typeof Breinify&&!Breinify.plugins._isAdded("assets")){var a=Breinify.UTL._jquery(),b=Breinify.plugins._overload(),c=Breinify.UTL.constants.errors.prefix.assets,d={resultCache:{},textResource:function(b,d){a.getJSON("https://assets.breinify.com/frame/"+b,function(a){d(null,a)}).fail(function(a,e,f){d({error:c+' Unable to retrieve resource from "'+b+'"',textStatus:e,responseText:a.responseText})})},determineDataTagsResourceValue:function(b,c,d,e){var f=this;"string"!=typeof c||""===c.trim()||"string"!=typeof d||""===d.trim()?e(null,null):a.isPlainObject(this.resultCache[b])?this.extractDataTagsSettings(c,d,this.resultCache[b],e):"boolean"==typeof this.resultCache[b]?this.resultCache[b]===!0?setTimeout(function(){f.determineDataTagsResourceValue(b,c,d,e)},10):e(null,null):(this.resultCache[b]=!0,this.textResource(b,function(a,g){null===a?(f.resultCache[b]=g,f.extractDataTagsSettings(c,d,g,e)):(f.resultCache[b]=!1,e(null,null))}))},determineTextResourceValue:function(b,c,d,e,f){var g=this;"string"!=typeof d||""===d.trim()?e(null,null):a.isPlainObject(this.resultCache[b])?this.extractResource(f,c,d,this.resultCache[b],e):"boolean"==typeof this.resultCache[b]?this.resultCache[b]===!0?setTimeout(function(){g.determineTextResourceValue(b,c,d,e,f)},10):e(null,null):(this.resultCache[b]=!0,this.textResource(b,function(a,h){null===a?(g.resultCache[b]=h,g.extractResource(f,c,d,h,e)):(g.resultCache[b]=!1,e(null,null))}))},registerNamedResourcesDataTagsObserver:function(){var b=this;Breinify.UTL.dom.addModification("assets::namedResourcesDataTagsObserver",{selector:'[data-frameId][data-personalize-group][data-personalize-item][data-personalize-value][data-frameLoaded!="true"]',modifier:function(c){c.each(function(){var c=a(this),d=c.attr("data-frameId"),e=c.attr("data-personalize-group"),f=c.attr("data-personalize-item");c.attr("data-personalize-value");b.determineDataTagsResourceValue(d,e,f,function(a){console.log(a),c.attr("data-frameLoaded","true").show()})})}})},registerNamedResourcesImgObserver:function(){var b=this;Breinify.UTL.dom.addModification("assets::namedResourcesImgObserver",{selector:'img[data-frameId][data-resourceType][data-resourceId][data-frameLoaded!="true"]',modifier:function(c){c.each(function(){var c=a(this),d=c.attr("data-frameId"),e=c.attr("data-resourceType"),f=c.attr("data-resourceId"),g=c.attr("data-fallbackSrc");b.determineTextResourceValue(d,e,f,function(a,b){"string"==typeof a&&""!==a.trim()?c.attr("src",a):"string"==typeof g&&""!==g.trim()?c.attr("src",g):c.attr("src",""),""!==c.attr("src").trim()&&c.attr("data-frameLoaded","true").show()})})}})},extractDataTagsSettings:function(a,b,c,d){console.log(a),d(null,null)},extractResource:function(b,c,d,e,f){var g;if("number"==typeof b)g=Math.floor(b/1e3);else if(Breinify.UTL.loc.hasParam("assetTimestamp")){var h=Breinify.UTL.loc.param("assetTimestamp");/[0-9]+/.test(h)&&(g=parseInt(h))}g="number"==typeof g?g:Math.floor((new Date).getTime()/1e3);var i;if(a.isPlainObject(e.themes)){for(var j=null,k=Object.keys(e.themes),l=0,m=k.length;l<m;l++){var n=e.themes[k[l]],o="number"==typeof n.start?n.start:null,p="number"==typeof n.end?n.end:null;if(null===o);else if(g>=o&&(null===p||g<p)){j=k[l];break}}if(i=e.fallbackThemes,i=a.isArray(i)?i:[],null!==j)i=[j].concat(i);else if(0===i.length)return void f(null,null)}else i=[null];for(var q=0,r=i.length;q<r;q++){var s=i[q],t=null===s?e:e.themes[s];if(a.isPlainObject(t)){var u=t[c];if(a.isPlainObject(u)){var v=u[d];if("string"==typeof v&&""!==v.trim())return void f(v,s)}}}f(null,null)}},e={observeNamedResourceDomElements:function(b){b=a.extend({imgObserver:this.getConfig("observeImages",!1),dataTagsObserver:this.getConfig("observeDataTags",!1)},b),b.imgObserver===!0&&d.registerNamedResourcesImgObserver(),b.dataTagsObserver===!0&&d.registerNamedResourcesDataTagsObserver()},textResource:function(){b.overload({"String,Function":function(a,b){d.textResource(a,b)},"String,String,String,Function,Number":function(a,b,c,e,f){d.determineTextResourceValue(a,b,c,e,f)}},arguments,this)}},f=Breinify.plugins._add("assets",e);Breinify.onReady(function(){f.observeNamedResourceDomElements()})}}();
<html>
<head>
    <link rel="stylesheet" type="text/css" href="css/simple-sample.css">

    <script src="js/breinify-api.js"></script>

    <!-- just for test purposes we add another jQuery library -->
    <script src="js/jquery.js"></script>

    <title>Sample: brein-api-javascript-browser (aka breinify-api.js)</title>

    <style>
        h1 {
            font-size: 20px;
            font-weight: bold;
            padding-left: 5px;
            padding-bottom: 10px;
        }

        h1:not(:first-child) {
            padding-top: 20px;
        }

        table {
            border-collapse: collapse;
            max-width: 600px;
            width: 100%;
        }

        th, td {
            text-align: left;
            padding: 8px;
        }

        th:first-child {
            width: 250px
        }

        tr:nth-child(even) {
            background-color: #f2f2f2
        }

        th {
            background-color: #4CAF50;
            color: white;
        }
    </style>
</head>
<body>
<div class="frame">

    <h1>General Information</h1>
    <table>
        <tr>
            <th>Property</th>
            <th>Value</th>
        </tr>
        <tr>
            <td>Breinify Library Version</td>
            <td id="breinify-version"></td>
        </tr>
        <tr>
            <td>Breinify jQuery Version</td>
            <td id="breinify-jquery-version"></td>
        </tr>
        <tr>
            <td>External jQuery Version</td>
            <td id="external-jquery-version"></td>
        </tr>
    </table>

    <h1>Current Configuration</h1>
    <table data-sort="true">
        <tr>
            <th>Property</th>
            <th>Value</th>
        </tr>
        <tr id="clonable-configuration-row" style="display:none">
            <td></td>
            <td></td>
        </tr>
    </table>

    <h1>LookUp Example</h1>
    <table data-sort="true">
        <tr>
            <th>Dimension</th>
            <th>Value</th>
        </tr>
        <tr id="dimension-email">
            <td>diane.keng@breinify.com</td>
            <td></td>
        </tr>
    </table>
</div>

<script language="javascript">

    //noinspection JSUnresolvedVariable
    var breinify = Breinify;

    // set the general configuration
    if (Breinify.UTL.loc.matches('^http://localhost:20000')) {
        breinify.setConfig({
            'url': 'http://dev.breinify.com/api',
            'apiKey': '5ABA-01F8-8855-4E9B-AB35-DAD7-F4B7-D752'
        });
    } else {
        breinify.setConfig({
            'apiKey': '9D3C-C7E8-BC93-4D1D-9A61-3A0F-9BD9-CF14'
        });
    }

    // set the external version
    $('#breinify-version').text(breinify.version);
    $('#breinify-jquery-version').text(breinify.jQueryVersion);
    $('#external-jquery-version').text($.fn.jquery);

    // show the configuration
    var config = breinify.config();
    var clonableRow = $('#clonable-configuration-row');
    $.each(config, function (property, value) {

        var row = clonableRow.clone(false);
        row.children('td:first-child').text(property);

        // format the value if it's null
        if (typeof  value === 'undefined' || value === null) {
            row.children('td:nth-child(2)').html('<span style="font-style:italic">' + value + '</span>');
        } else {
            row.children('td:nth-child(2)').text(value);
        }

        // append the created clone
        row.removeAttr('id', null).show().appendTo(clonableRow.parent());
    });

    // sort all the tables
    $('table[data-sort="true"]').each(function (idx, el) {
        var $el = $(el);

        $el.find('tr').sort(function (a, b) {
            var $aTd = $('td:nth-child(1)', a);
            var $bTd = $('td:nth-child(1)', b);

            return $aTd.text().localeCompare($bTd.text());
        }).appendTo($el);
    });

    // now use the whole library whenever needed to send information
    breinify.activity({
        'email': 'philipp.meisen@breinify.com'
    }, 'search');

    breinify.lookup({
        'email': breinify.UTL.text('#dimension-email td:first-child')
    }, ['firstname'], false, function (data) {

        var val;
        if (breinify.UTL.isEmpty(data)) {
            val = 'undefined';
        } else {
            val = data.firstname.result + ' (' + data.firstname.accuracy + ')';
        }

        $('#dimension-email').find('td:nth-child(2)').text(val)
    });

</script>

</body>
</html>